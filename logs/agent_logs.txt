2025-06-21 16:51:25,207 � INFO � Loaded input CSV: C:\Users\rahul\OneDrive\Desktop\Data_cleaning_agent\data\temp_input.csv
2025-06-21 16:51:25,208 � INFO � --- Pipeline Iteration 1 ---
2025-06-21 16:51:25,259 � INFO � [Detection Agent]  12 missing or malformed emails | [(2, 'bob.lee'), (3, 'elijah.whitecom'), (4, 'matthew'), (8, nan), (11, 'olivia.garcia@example.'), (14, 'isabella.anderson@example'), (20, 'james.clark@'), (22, nan), (24, 'daniel.scott@.com'), (28, 'example.com'), (29, 'grace.perezexample.com'), (35, 'example.com')]
2025-06-21 16:51:25,259 � INFO � [Detection Agent]  5 invalid phone numbers | [(3, '0'), (16, '551'), (22, '-9'), (26, '055-774'), (29, nan)]
2025-06-21 16:51:25,260 � INFO � [Detection Agent]  4 invalid gender | [(12, nan), (14, 'na'), (20, 'not tell'), (26, nan)]
2025-06-21 16:51:25,260 � INFO � [Detection Agent]  1 invalid marital status | [(4, nan)]
2025-06-21 16:51:25,260 � INFO � [Detection Agent]  3 missing, negative, or implausible ages | [(13, nan), (16, nan), (17, -9.0)]
2025-06-21 16:51:25,260 � INFO � [Detection Agent]  2 invalid loyalty points | [(6, nan), (22, -90.0)]
2025-06-21 16:51:25,260 � INFO � [Detection Agent]  36 non-canonical or misspelled countries | [(0, 'Unted Stats'), (1, 'Inda'), (2, 'Frnce'), (3, 'Austraila'), (4, 'Unid Kngdom'), (5, 'Frace'), (6, 'Ind'), (7, 'Unted Stats'), (8, 'Inida'), (9, 'Cnada'), (10, 'Unted Stats'), (11, nan), (12, 'Austrailia'), (13, 'Austraila'), (14, 'Soth Korea'), (15, 'Unted St'), (16, 'uni'), (17, ' au'), (18, 'Cnada'), (19, 'Frnce'), (20, 'Soth Korea'), (21, nan), (22, 'Unted Stats'), (23, 'Cina'), (24, 'Austraila'), (25, 'Untedst'), (26, 'Austarl'), (27, 'Frnce'), (28, 'Unted Stats'), (29, 'Caa'), (30, 'Cina'), (31, 'Inda'), (32, 'Unted Stats'), (33, 'Austraila'), (34, 'Austraila'), (35, 'Unted Stats')]
2025-06-21 16:51:25,260 � INFO � [Detection Agent]  2 duplicate rows found. | [7, 32]
2025-06-21 16:51:25,260 � INFO � [Detection Agent]  2 empty first_name | [(9, nan), (20, nan)]
2025-06-21 16:51:25,260 � INFO � [Detection Agent]  2 empty last_name | [(19, nan), (23, nan)]
2025-06-21 16:51:25,260 � INFO � [Detection Agent]  2 empty full_name | [(18, nan), (27, nan)]
2025-06-21 16:51:25,261 � INFO � Correction needed, forwarding to Correction Agent.
2025-06-21 16:51:25,291 � INFO � [Correction Agent]  Standardized first_name | [(9, nan, 'Unknown'), (20, nan, 'Unknown')]
2025-06-21 16:51:25,291 � INFO � [Correction Agent]  Standardized last_name | [(19, nan, 'Unknown'), (23, nan, 'Unknown')]
2025-06-21 16:51:25,291 � INFO � [Correction Agent]  Standardized full_name | [(2, 'Bob lee', 'Bob Lee'), (10, 'Etha lee', 'Etha Lee'), (18, nan, 'Unknown'), (27, nan, 'Unknown')]
2025-06-21 16:51:25,291 � INFO � [Correction Agent]  Removed 1 duplicate rows.
2025-06-21 16:51:25,291 � INFO � [Correction Agent]  Standardized country using fuzzy matching | [(0, 'Unted Stats', 'United States'), (1, 'Inda', 'India'), (2, 'Frnce', 'France'), (3, 'Austraila', 'Australia'), (4, 'Unid Kngdom', 'United Kingdom'), (5, 'Frace', 'France'), (6, 'Ind', 'India'), (7, 'Unted Stats', 'United States'), (8, 'Inida', 'India'), (9, 'Cnada', 'Canada'), (10, 'Unted Stats', 'United States'), (11, nan, 'Unknown'), (12, 'Austrailia', 'Australia'), (13, 'Austraila', 'Australia'), (14, 'Soth Korea', 'South Korea'), (15, 'Unted St', 'United States'), (16, 'uni', 'Unknown'), (17, ' au', 'Unknown'), (18, 'Cnada', 'Canada'), (19, 'Frnce', 'France'), (20, 'Soth Korea', 'South Korea'), (21, nan, 'Unknown'), (22, 'Unted Stats', 'United States'), (23, 'Cina', 'China'), (24, 'Austraila', 'Australia'), (25, 'Untedst', 'Unknown'), (26, 'Austarl', 'Australia'), (27, 'Frnce', 'France'), (28, 'Unted Stats', 'United States'), (29, 'Caa', 'Unknown'), (30, 'Cina', 'China'), (31, 'Inda', 'India'), (32, 'Austraila', 'Australia'), (33, 'Austraila', 'Australia'), (34, 'Unted Stats', 'United States')]
2025-06-21 16:51:25,291 � INFO � [Correction Agent]  Standardized age | [(13, nan, 45.0), (16, nan, 45.0), (17, -9.0, 45.0)]
2025-06-21 16:51:25,291 � INFO � [Correction Agent]  Standardized loyalty_points | [(6, nan, 0.0), (22, -90.0, 0.0)]
2025-06-21 16:51:25,292 � INFO � [Correction Agent]  Standardized gender | [(12, nan, 'Other'), (14, 'na', 'Other'), (20, 'not tell', 'Other'), (26, nan, 'Other')]
2025-06-21 16:51:25,292 � INFO � [Correction Agent]  Standardized marital_status | [(4, nan, 'Single')]
2025-06-21 16:51:25,292 � INFO � [Correction Agent]  Standardized phone | [(3, '0', '0000-0000'), (16, '551', '0000-0551'), (22, '-9', '0000-0009'), (26, '055-774', '0005-5774'), (29, nan, '0000-0000')]
2025-06-21 16:51:25,292 � INFO � [Correction Agent]  Standardized city using fuzzy matching | [(6, 'Unknown', nan), (9, 'Los Angeles', 'Los'), (11, 'San', 'Unknown'), (12, 'Riverside', 'River'), (18, 'Unknown', nan), (26, 'Miami', 'Mia'), (28, 'Los Angeles', 'Los Ange'), (29, 'St City', 'Star City')]
2025-06-21 16:51:25,293 � INFO � Enrichment needed after correction, forwarding to Enrichment Agent.
2025-06-21 16:53:38,267 � INFO � [Enrichment Agent]  Column: first_name | [(9, 'Unknown', 'Ava'), (20, 'Unknown', 'James')]
2025-06-21 16:53:38,268 � INFO � [Enrichment Agent]  Column: last_name | [(19, 'Unknown', 'Harris'), (23, 'Unknown', 'Wright')]
2025-06-21 16:53:38,268 � INFO � [Enrichment Agent]  Column: full_name | [(18, 'Unknown', 'Amelia Smith'), (27, 'Unknown', 'David Nelson')]
2025-06-21 16:53:38,268 � INFO � [Enrichment Agent]  Column: email | [(8, nan, 'chloe.turner@example.com'), (22, nan, 'alexander.king@example.com')]
2025-06-21 16:53:38,268 � INFO � [Enrichment Agent]  Column: address | [(13, nan, '789 Pine Rd'), (24, nan, '987 Birch')]
2025-06-21 16:53:38,269 � INFO � [Enrichment Agent]  Column: city | [(6, 'Unknown', 'Austin'), (11, 'Unknown', 'Austin'), (18, 'Unknown', 'Gotham')]
2025-06-21 16:53:38,269 � INFO � [Enrichment Agent]  Column: state | [(10, nan, 'WA'), (22, nan, 'CA')]
2025-06-21 16:53:38,269 � INFO � [Enrichment Agent]  Column: country | [(11, 'Unknown', 'United States'), (16, 'Unknown', 'United States'), (17, 'Unknown', 'United States'), (21, 'Unknown', 'United States'), (25, 'Unknown', 'United States'), (29, 'Unknown', 'United States')]
2025-06-21 16:53:38,269 � INFO � [Enrichment Agent]  Column: signup_date | [(11, nan, '01-01-2023')]
2025-06-21 16:53:38,269 � INFO � [Enrichment Agent]  Column: last_purchase | [(1, nan, '01-01-2024')]
2025-06-21 16:53:38,269 � INFO � [Enrichment Agent]  Column: occupation | [(26, nan, 'Designer')]
2025-06-21 16:53:38,269 � INFO � [Enrichment Agent]  Column: is_loyal_customer | [(0, 'Yes'), (1, 'Yes'), (2, 'Yes'), (3, 'No'), (4, 'Yes'), (5, 'No'), (6, 'No'), (7, 'No'), (8, 'Yes'), (9, 'Yes'), (10, 'Yes'), (11, 'Yes'), (12, 'No'), (13, 'No'), (14, 'No'), (15, 'No'), (16, 'No'), (17, 'Yes'), (18, 'Yes'), (19, 'Yes'), (20, 'Yes'), (21, 'Yes'), (22, 'No'), (23, 'Yes'), (24, 'Yes'), (25, 'Yes'), (26, 'Yes'), (27, 'Yes'), (28, 'Yes'), (29, 'Yes'), (30, 'Yes'), (31, 'Yes'), (32, 'Yes'), (33, 'No'), (34, 'Yes')]
2025-06-21 16:53:38,269 � INFO � [Enrichment Agent]  Column: customer_persona | [(0, 'Analytical and practical; values efficiency and reliable products. Independent buyer; often prioritizes personal preferences.'), (1, 'Community-oriented and value-driven; seeks quality and practical solutions. Highly loyal; likely appreciates reward programs and brand consistency.'), (2, 'Creative and aesthetic-conscious; drawn to unique and inspiring products. Highly loyal; likely appreciates reward programs and brand consistency.'), (3, 'Analytical and practical; values efficiency and reliable products. May be an infrequent buyer or exploring options; needs incentives for repeat purchases.'), (4, 'Community-oriented and value-driven; seeks quality and practical solutions. Highly loyal; likely appreciates reward programs and brand consistency.'), (5, 'Analytical and practical; values efficiency and reliable products. May be an infrequent buyer or exploring options; needs incentives for repeat purchases.'), (6, 'Community-oriented and value-driven; seeks quality and practical solutions. May be an infrequent buyer or exploring options; needs incentives for repeat purchases.'), (7, 'Analytical and practical; values efficiency and reliable products. May be an infrequent buyer or exploring options; needs incentives for repeat purchases.'), (8, 'Creative and aesthetic-conscious; drawn to unique and inspiring products. Highly loyal; likely appreciates reward programs and brand consistency.'), (9, 'Analytical and practical; values efficiency and reliable products. Highly loyal; likely appreciates reward programs and brand consistency.'), (10, 'Analytical and practical; values efficiency and reliable products. Highly loyal; likely appreciates reward programs and brand consistency.'), (11, 'Creative and aesthetic-conscious; drawn to unique and inspiring products. Highly loyal; likely appreciates reward programs and brand consistency.'), (12, 'Analytical and practical; values efficiency and reliable products. May be an infrequent buyer or exploring options; needs incentives for repeat purchases.'), (13, 'Creative and aesthetic-conscious; drawn to unique and inspiring products. May be an infrequent buyer or exploring options; needs incentives for repeat purchases.'), (14, 'Creative and aesthetic-conscious; drawn to unique and inspiring products. May be an infrequent buyer or exploring options; needs incentives for repeat purchases.'), (15, 'Analytical and practical; values efficiency and reliable products. May be an infrequent buyer or exploring options; needs incentives for repeat purchases.'), (16, 'Community-oriented and value-driven; seeks quality and practical solutions. May be an infrequent buyer or exploring options; needs incentives for repeat purchases.'), (17, 'Creative and aesthetic-conscious; drawn to unique and inspiring products. Highly loyal; likely appreciates reward programs and brand consistency.'), (18, 'Creative and aesthetic-conscious; drawn to unique and inspiring products. Highly loyal; likely appreciates reward programs and brand consistency.'), (19, 'Analytical and practical; values efficiency and reliable products. Highly loyal; likely appreciates reward programs and brand consistency.'), (20, 'Community-oriented and value-driven; seeks quality and practical solutions. Highly loyal; likely appreciates reward programs and brand consistency.'), (21, 'Creative and aesthetic-conscious; drawn to unique and inspiring products. Highly loyal; likely appreciates reward programs and brand consistency.'), (22, 'Analytical and practical; values efficiency and reliable products. May be an infrequent buyer or exploring options; needs incentives for repeat purchases.'), (23, 'Community-oriented and value-driven; seeks quality and practical solutions. Highly loyal; likely appreciates reward programs and brand consistency.'), (24, 'Creative and aesthetic-conscious; drawn to unique and inspiring products. Highly loyal; likely appreciates reward programs and brand consistency.'), (25, 'Creative and aesthetic-conscious; drawn to unique and inspiring products. Highly loyal; likely appreciates reward programs and brand consistency.'), (26, 'Creative and aesthetic-conscious; drawn to unique and inspiring products. Highly loyal; likely appreciates reward programs and brand consistency.'), (27, 'Creative and aesthetic-conscious; drawn to unique and inspiring products. Highly loyal; likely appreciates reward programs and brand consistency.'), (28, 'Analytical and practical; values efficiency and reliable products. Highly loyal; likely appreciates reward programs and brand consistency.'), (29, 'Creative and aesthetic-conscious; drawn to unique and inspiring products. Highly loyal; likely appreciates reward programs and brand consistency.'), (30, 'Analytical and practical; values efficiency and reliable products. Highly loyal; likely appreciates reward programs and brand consistency.'), (31, 'Analytical and practical; values efficiency and reliable products. Highly loyal; likely appreciates reward programs and brand consistency.'), (32, 'Creative and aesthetic-conscious; drawn to unique and inspiring products. Highly loyal; likely appreciates reward programs and brand consistency.'), (33, 'Analytical and practical; values efficiency and reliable products. May be an infrequent buyer or exploring options; needs incentives for repeat purchases.'), (34, 'Analytical and practical; values efficiency and reliable products. Highly loyal; likely appreciates reward programs and brand consistency.')]
2025-06-21 16:53:38,269 � INFO � [Enrichment Agent] Enriched all missing values and added is_loyal_customer and customer_persona using Gemini in a single prompt (strict CSV format).
2025-06-21 16:53:38,269 � INFO � Forwarding to Detection Agent for re-check.
2025-06-21 16:53:38,269 � INFO � --- Pipeline Iteration 2 ---
2025-06-21 16:53:38,302 � INFO � [Detection Agent]  1 missing or malformed emails | [(3, 'elijah.white.com')]
2025-06-21 16:53:38,303 � INFO � [Detection Agent]  0 invalid phone numbers | []
2025-06-21 16:53:38,304 � INFO � [Detection Agent]  0 invalid gender | []
2025-06-21 16:53:38,304 � INFO � [Detection Agent]  0 invalid marital status | []
2025-06-21 16:53:38,304 � INFO � [Detection Agent]  0 missing, negative, or implausible ages | []
2025-06-21 16:53:38,304 � INFO � [Detection Agent]  0 invalid loyalty points | []
2025-06-21 16:53:38,304 � INFO � [Detection Agent]  0 non-canonical or misspelled countries | []
2025-06-21 16:53:38,304 � INFO � [Detection Agent]  0 duplicate rows found. | []
2025-06-21 16:53:38,304 � INFO � [Detection Agent]  0 empty first_name | []
2025-06-21 16:53:38,304 � INFO � [Detection Agent]  0 empty last_name | []
2025-06-21 16:53:38,304 � INFO � [Detection Agent]  0 empty full_name | []
2025-06-21 16:53:38,306 � INFO � Correction needed, forwarding to Correction Agent.
2025-06-21 16:53:38,333 � INFO � [Correction Agent]  Standardized city using fuzzy matching | [{'Houston', 'Austin', 6}, {'Houston', 11, 'Austin'}]
2025-06-21 16:53:38,364 � INFO � No enrichment needed after correction.
2025-06-21 16:53:38,369 � INFO � Saved cleaned CSV: C:\Users\rahul\OneDrive\Desktop\Data_cleaning_agent\data\temp_output.csv
